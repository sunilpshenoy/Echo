/*! For license information please see main.775e75bc.js.LICENSE.txt */
(()=>{var e={445:(e,t)=>{"use strict";t.byteLength=function(e){var t=o(e),n=t[0],a=t[1];return 3*(n+a)/4-a},t.toByteArray=function(e){var t,n,i=o(e),f=i[0],s=i[1],l=new r(function(e,t,n){return 3*(t+n)/4-n}(0,f,s)),u=0,c=s>0?f-4:f;for(n=0;n<c;n+=4)t=a[e.charCodeAt(n)]<<18|a[e.charCodeAt(n+1)]<<12|a[e.charCodeAt(n+2)]<<6|a[e.charCodeAt(n+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;2===s&&(t=a[e.charCodeAt(n)]<<2|a[e.charCodeAt(n+1)]>>4,l[u++]=255&t);1===s&&(t=a[e.charCodeAt(n)]<<10|a[e.charCodeAt(n+1)]<<4|a[e.charCodeAt(n+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t);return l},t.fromByteArray=function(e){for(var t,a=e.length,r=a%3,i=[],f=16383,o=0,l=a-r;o<l;o+=f)i.push(s(e,o,o+f>l?l:o+f));1===r?(t=e[a-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===r&&(t=(e[a-2]<<8)+e[a-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return i.join("")};for(var n=[],a=[],r="undefined"!==typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0;f<64;++f)n[f]=i[f],a[i.charCodeAt(f)]=f;function o(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function s(e,t,a){for(var r,i,f=[],o=t;o<a;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),f.push(n[(i=r)>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return f.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},382:(e,t,n)=>{"use strict";const a=n(445),r=n(900),i="function"===typeof Symbol&&"function"===typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=s,t.SlowBuffer=function(e){+e!=e&&(e=0);return s.alloc(+e)},t.INSPECT_MAX_BYTES=50;const f=2147483647;function o(e){if(e>f)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,s.prototype),t}function s(e,t,n){if("number"===typeof e){if("string"===typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return c(e)}return l(e,t,n)}function l(e,t,n){if("string"===typeof e)return function(e,t){"string"===typeof t&&""!==t||(t="utf8");if(!s.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|g(e,t);let a=o(n);const r=a.write(e,t);r!==n&&(a=a.slice(0,r));return a}(e,t);if(ArrayBuffer.isView(e))return function(e){if(W(e,Uint8Array)){const t=new Uint8Array(e);return h(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(W(e,ArrayBuffer)||e&&W(e.buffer,ArrayBuffer))return h(e,t,n);if("undefined"!==typeof SharedArrayBuffer&&(W(e,SharedArrayBuffer)||e&&W(e.buffer,SharedArrayBuffer)))return h(e,t,n);if("number"===typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const a=e.valueOf&&e.valueOf();if(null!=a&&a!==e)return s.from(a,t,n);const r=function(e){if(s.isBuffer(e)){const t=0|p(e.length),n=o(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!==typeof e.length||q(e.length)?o(0):d(e);if("Buffer"===e.type&&Array.isArray(e.data))return d(e.data)}(e);if(r)return r;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!==typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return u(e),o(e<0?0:0|p(e))}function d(e){const t=e.length<0?0:0|p(e.length),n=o(t);for(let a=0;a<t;a+=1)n[a]=255&e[a];return n}function h(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let a;return a=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(a,s.prototype),a}function p(e){if(e>=f)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+f.toString(16)+" bytes");return 0|e}function g(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||W(e,ArrayBuffer))return e.byteLength;if("string"!==typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,a=arguments.length>2&&!0===arguments[2];if(!a&&0===n)return 0;let r=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Z(e).length;default:if(r)return a?-1:G(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){let a=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return E(this,t,n);case"utf8":case"utf-8":return x(this,t,n);case"ascii":return k(this,t,n);case"latin1":case"binary":return N(this,t,n);case"base64":return j(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,n);default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function b(e,t,n){const a=e[t];e[t]=e[n],e[n]=a}function w(e,t,n,a,r){if(0===e.length)return-1;if("string"===typeof n?(a=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),q(n=+n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"===typeof t&&(t=s.from(t,a)),s.isBuffer(t))return 0===t.length?-1:y(e,t,n,a,r);if("number"===typeof t)return t&=255,"function"===typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,a,r);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,a,r){let i,f=1,o=e.length,s=t.length;if(void 0!==a&&("ucs2"===(a=String(a).toLowerCase())||"ucs-2"===a||"utf16le"===a||"utf-16le"===a)){if(e.length<2||t.length<2)return-1;f=2,o/=2,s/=2,n/=2}function l(e,t){return 1===f?e[t]:e.readUInt16BE(t*f)}if(r){let a=-1;for(i=n;i<o;i++)if(l(e,i)===l(t,-1===a?0:i-a)){if(-1===a&&(a=i),i-a+1===s)return a*f}else-1!==a&&(i-=i-a),a=-1}else for(n+s>o&&(n=o-s),i=n;i>=0;i--){let n=!0;for(let a=0;a<s;a++)if(l(e,i+a)!==l(t,a)){n=!1;break}if(n)return i}return-1}function v(e,t,n,a){n=Number(n)||0;const r=e.length-n;a?(a=Number(a))>r&&(a=r):a=r;const i=t.length;let f;for(a>i/2&&(a=i/2),f=0;f<a;++f){const a=parseInt(t.substr(2*f,2),16);if(q(a))return f;e[n+f]=a}return f}function _(e,t,n,a){return V(G(t,e.length-n),e,n,a)}function M(e,t,n,a){return V(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,a)}function L(e,t,n,a){return V(Z(t),e,n,a)}function C(e,t,n,a){return V(function(e,t){let n,a,r;const i=[];for(let f=0;f<e.length&&!((t-=2)<0);++f)n=e.charCodeAt(f),a=n>>8,r=n%256,i.push(r),i.push(a);return i}(t,e.length-n),e,n,a)}function j(e,t,n){return 0===t&&n===e.length?a.fromByteArray(e):a.fromByteArray(e.slice(t,n))}function x(e,t,n){n=Math.min(e.length,n);const a=[];let r=t;for(;r<n;){const t=e[r];let i=null,f=t>239?4:t>223?3:t>191?2:1;if(r+f<=n){let n,a,o,s;switch(f){case 1:t<128&&(i=t);break;case 2:n=e[r+1],128===(192&n)&&(s=(31&t)<<6|63&n,s>127&&(i=s));break;case 3:n=e[r+1],a=e[r+2],128===(192&n)&&128===(192&a)&&(s=(15&t)<<12|(63&n)<<6|63&a,s>2047&&(s<55296||s>57343)&&(i=s));break;case 4:n=e[r+1],a=e[r+2],o=e[r+3],128===(192&n)&&128===(192&a)&&128===(192&o)&&(s=(15&t)<<18|(63&n)<<12|(63&a)<<6|63&o,s>65535&&s<1114112&&(i=s))}}null===i?(i=65533,f=1):i>65535&&(i-=65536,a.push(i>>>10&1023|55296),i=56320|1023&i),a.push(i),r+=f}return function(e){const t=e.length;if(t<=S)return String.fromCharCode.apply(String,e);let n="",a=0;for(;a<t;)n+=String.fromCharCode.apply(String,e.slice(a,a+=S));return n}(a)}t.kMaxLength=f,s.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(e,t,n){return l(e,t,n)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(e,t,n){return function(e,t,n){return u(e),e<=0?o(e):void 0!==t?"string"===typeof n?o(e).fill(t,n):o(e).fill(t):o(e)}(e,t,n)},s.allocUnsafe=function(e){return c(e)},s.allocUnsafeSlow=function(e){return c(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(W(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),W(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,a=t.length;for(let r=0,i=Math.min(n,a);r<i;++r)if(e[r]!==t[r]){n=e[r],a=t[r];break}return n<a?-1:a<n?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const a=s.allocUnsafe(t);let r=0;for(n=0;n<e.length;++n){let t=e[n];if(W(t,Uint8Array))r+t.length>a.length?(s.isBuffer(t)||(t=s.from(t)),t.copy(a,r)):Uint8Array.prototype.set.call(a,t,r);else{if(!s.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(a,r)}r+=t.length}return a},s.byteLength=g,s.prototype._isBuffer=!0,s.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)b(this,t,t+1);return this},s.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)b(this,t,t+3),b(this,t+1,t+2);return this},s.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)b(this,t,t+7),b(this,t+1,t+6),b(this,t+2,t+5),b(this,t+3,t+4);return this},s.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?x(this,0,e):m.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},i&&(s.prototype[i]=s.prototype.inspect),s.prototype.compare=function(e,t,n,a,r){if(W(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===a&&(a=0),void 0===r&&(r=this.length),t<0||n>e.length||a<0||r>this.length)throw new RangeError("out of range index");if(a>=r&&t>=n)return 0;if(a>=r)return-1;if(t>=n)return 1;if(this===e)return 0;let i=(r>>>=0)-(a>>>=0),f=(n>>>=0)-(t>>>=0);const o=Math.min(i,f),l=this.slice(a,r),u=e.slice(t,n);for(let s=0;s<o;++s)if(l[s]!==u[s]){i=l[s],f=u[s];break}return i<f?-1:f<i?1:0},s.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},s.prototype.indexOf=function(e,t,n){return w(this,e,t,n,!0)},s.prototype.lastIndexOf=function(e,t,n){return w(this,e,t,n,!1)},s.prototype.write=function(e,t,n,a){if(void 0===t)a="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)a=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===a&&(a="utf8")):(a=n,n=void 0)}const r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");a||(a="utf8");let i=!1;for(;;)switch(a){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":case"latin1":case"binary":return M(this,e,t,n);case"base64":return L(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),i=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const S=4096;function k(e,t,n){let a="";n=Math.min(e.length,n);for(let r=t;r<n;++r)a+=String.fromCharCode(127&e[r]);return a}function N(e,t,n){let a="";n=Math.min(e.length,n);for(let r=t;r<n;++r)a+=String.fromCharCode(e[r]);return a}function E(e,t,n){const a=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>a)&&(n=a);let r="";for(let i=t;i<n;++i)r+=X[e[i]];return r}function I(e,t,n){const a=e.slice(t,n);let r="";for(let i=0;i<a.length-1;i+=2)r+=String.fromCharCode(a[i]+256*a[i+1]);return r}function T(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function A(e,t,n,a,r,i){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<i)throw new RangeError('"value" argument is out of bounds');if(n+a>e.length)throw new RangeError("Index out of range")}function D(e,t,n,a,r){Q(t,a,r,e,n,7);let i=Number(t&BigInt(4294967295));e[n++]=i,i>>=8,e[n++]=i,i>>=8,e[n++]=i,i>>=8,e[n++]=i;let f=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=f,f>>=8,e[n++]=f,f>>=8,e[n++]=f,f>>=8,e[n++]=f,n}function R(e,t,n,a,r){Q(t,a,r,e,n,7);let i=Number(t&BigInt(4294967295));e[n+7]=i,i>>=8,e[n+6]=i,i>>=8,e[n+5]=i,i>>=8,e[n+4]=i;let f=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=f,f>>=8,e[n+2]=f,f>>=8,e[n+1]=f,f>>=8,e[n]=f,n+8}function z(e,t,n,a,r,i){if(n+a>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function P(e,t,n,a,i){return t=+t,n>>>=0,i||z(e,0,n,4),r.write(e,t,n,a,23,4),n+4}function B(e,t,n,a,i){return t=+t,n>>>=0,i||z(e,0,n,8),r.write(e,t,n,a,52,8),n+8}s.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const a=this.subarray(e,t);return Object.setPrototypeOf(a,s.prototype),a},s.prototype.readUintLE=s.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||T(e,t,this.length);let a=this[e],r=1,i=0;for(;++i<t&&(r*=256);)a+=this[e+i]*r;return a},s.prototype.readUintBE=s.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||T(e,t,this.length);let a=this[e+--t],r=1;for(;t>0&&(r*=256);)a+=this[e+--t]*r;return a},s.prototype.readUint8=s.prototype.readUInt8=function(e,t){return e>>>=0,t||T(e,1,this.length),this[e]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||T(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||T(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||T(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||T(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readBigUInt64LE=K((function(e){H(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||F(e,this.length-8);const a=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,r=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(a)+(BigInt(r)<<BigInt(32))})),s.prototype.readBigUInt64BE=K((function(e){H(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||F(e,this.length-8);const a=t*2**24+65536*this[++e]+256*this[++e]+this[++e],r=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(a)<<BigInt(32))+BigInt(r)})),s.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||T(e,t,this.length);let a=this[e],r=1,i=0;for(;++i<t&&(r*=256);)a+=this[e+i]*r;return r*=128,a>=r&&(a-=Math.pow(2,8*t)),a},s.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||T(e,t,this.length);let a=t,r=1,i=this[e+--a];for(;a>0&&(r*=256);)i+=this[e+--a]*r;return r*=128,i>=r&&(i-=Math.pow(2,8*t)),i},s.prototype.readInt8=function(e,t){return e>>>=0,t||T(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||T(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(e,t){e>>>=0,t||T(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||T(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||T(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readBigInt64LE=K((function(e){H(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||F(e,this.length-8);const a=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(a)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),s.prototype.readBigInt64BE=K((function(e){H(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||F(e,this.length-8);const a=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(a)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),s.prototype.readFloatLE=function(e,t){return e>>>=0,t||T(e,4,this.length),r.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||T(e,4,this.length),r.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||T(e,8,this.length),r.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||T(e,8,this.length),r.read(this,e,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(e,t,n,a){if(e=+e,t>>>=0,n>>>=0,!a){A(this,e,t,n,Math.pow(2,8*n)-1,0)}let r=1,i=0;for(this[t]=255&e;++i<n&&(r*=256);)this[t+i]=e/r&255;return t+n},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(e,t,n,a){if(e=+e,t>>>=0,n>>>=0,!a){A(this,e,t,n,Math.pow(2,8*n)-1,0)}let r=n-1,i=1;for(this[t+r]=255&e;--r>=0&&(i*=256);)this[t+r]=e/i&255;return t+n},s.prototype.writeUint8=s.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigUInt64LE=K((function(e){return D(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeBigUInt64BE=K((function(e){return R(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeIntLE=function(e,t,n,a){if(e=+e,t>>>=0,!a){const a=Math.pow(2,8*n-1);A(this,e,t,n,a-1,-a)}let r=0,i=1,f=0;for(this[t]=255&e;++r<n&&(i*=256);)e<0&&0===f&&0!==this[t+r-1]&&(f=1),this[t+r]=(e/i|0)-f&255;return t+n},s.prototype.writeIntBE=function(e,t,n,a){if(e=+e,t>>>=0,!a){const a=Math.pow(2,8*n-1);A(this,e,t,n,a-1,-a)}let r=n-1,i=1,f=0;for(this[t+r]=255&e;--r>=0&&(i*=256);)e<0&&0===f&&0!==this[t+r+1]&&(f=1),this[t+r]=(e/i|0)-f&255;return t+n},s.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigInt64LE=K((function(e){return D(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeBigInt64BE=K((function(e){return R(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeFloatLE=function(e,t,n){return P(this,e,t,!0,n)},s.prototype.writeFloatBE=function(e,t,n){return P(this,e,t,!1,n)},s.prototype.writeDoubleLE=function(e,t,n){return B(this,e,t,!0,n)},s.prototype.writeDoubleBE=function(e,t,n){return B(this,e,t,!1,n)},s.prototype.copy=function(e,t,n,a){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),a||0===a||(a=this.length),t>=e.length&&(t=e.length),t||(t=0),a>0&&a<n&&(a=n),a===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),e.length-t<a-n&&(a=e.length-t+n);const r=a-n;return this===e&&"function"===typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,a):Uint8Array.prototype.set.call(e,this.subarray(n,a),t),r},s.prototype.fill=function(e,t,n,a){if("string"===typeof e){if("string"===typeof t?(a=t,t=0,n=this.length):"string"===typeof n&&(a=n,n=this.length),void 0!==a&&"string"!==typeof a)throw new TypeError("encoding must be a string");if("string"===typeof a&&!s.isEncoding(a))throw new TypeError("Unknown encoding: "+a);if(1===e.length){const t=e.charCodeAt(0);("utf8"===a&&t<128||"latin1"===a)&&(e=t)}}else"number"===typeof e?e&=255:"boolean"===typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let r;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(r=t;r<n;++r)this[r]=e;else{const i=s.isBuffer(e)?e:s.from(e,a),f=i.length;if(0===f)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(r=0;r<n-t;++r)this[r+t]=i[r%f]}return this};const O={};function U(e,t,n){O[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name="".concat(this.name," [").concat(e,"]"),this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}}}function Y(e){let t="",n=e.length;const a="-"===e[0]?1:0;for(;n>=a+4;n-=3)t="_".concat(e.slice(n-3,n)).concat(t);return"".concat(e.slice(0,n)).concat(t)}function Q(e,t,n,a,r,i){if(e>n||e<t){const a="bigint"===typeof t?"n":"";let r;throw r=i>3?0===t||t===BigInt(0)?">= 0".concat(a," and < 2").concat(a," ** ").concat(8*(i+1)).concat(a):">= -(2".concat(a," ** ").concat(8*(i+1)-1).concat(a,") and < 2 ** ")+"".concat(8*(i+1)-1).concat(a):">= ".concat(t).concat(a," and <= ").concat(n).concat(a),new O.ERR_OUT_OF_RANGE("value",r,e)}!function(e,t,n){H(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||F(t,e.length-(n+1))}(a,r,i)}function H(e,t){if("number"!==typeof e)throw new O.ERR_INVALID_ARG_TYPE(t,"number",e)}function F(e,t,n){if(Math.floor(e)!==e)throw H(e,n),new O.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new O.ERR_BUFFER_OUT_OF_BOUNDS;throw new O.ERR_OUT_OF_RANGE(n||"offset",">= ".concat(n?1:0," and <= ").concat(t),e)}U("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?"".concat(e," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"}),RangeError),U("ERR_INVALID_ARG_TYPE",(function(e,t){return'The "'.concat(e,'" argument must be of type number. Received type ').concat(typeof t)}),TypeError),U("ERR_OUT_OF_RANGE",(function(e,t,n){let a='The value of "'.concat(e,'" is out of range.'),r=n;return Number.isInteger(n)&&Math.abs(n)>2**32?r=Y(String(n)):"bigint"===typeof n&&(r=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(r=Y(r)),r+="n"),a+=" It must be ".concat(t,". Received ").concat(r),a}),RangeError);const J=/[^+/0-9A-Za-z-_]/g;function G(e,t){let n;t=t||1/0;const a=e.length;let r=null;const i=[];for(let f=0;f<a;++f){if(n=e.charCodeAt(f),n>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(f+1===a){(t-=3)>-1&&i.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&i.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function Z(e){return a.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(J,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function V(e,t,n,a){let r;for(r=0;r<a&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}function W(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function q(e){return e!==e}const X=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const a=16*n;for(let r=0;r<16;++r)t[a+r]=e[n]+e[r]}return t}();function K(e){return"undefined"===typeof BigInt?$:e}function $(){throw new Error("BigInt not supported")}},522:(e,t,n)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let a=0,r=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(a++,"%c"===e&&(r=a))})),t.splice(r,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(n){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(n){}!e&&"undefined"!==typeof process&&"env"in process&&(e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:"443",FAST_REFRESH:!0,REACT_APP_BACKEND_URL:"https://1f08d9c4-28b0-437e-b8a1-ad0ba8b89e9a.preview.emergentagent.com",ms="".concat(gs,"/api"),bs=new(us())({bitRate:128});const ws=function(){var e,t,n,r,i,f;const[o,s]=(0,a.useState)("login"),[u,c]=(0,a.useState)(null),[d,h]=(0,a.useState)(localStorage.getItem("token")),[p,g]=(0,a.useState)([]),[m,b]=(0,a.useState)(null),[w,y]=(0,a.useState)([]),[v,_]=(0,a.useState)(""),[M,L]=(0,a.useState)([]),[C,j]=(0,a.useState)(null),[x,S]=(0,a.useState)(!1),k=(0,a.useRef)(null),N=(0,a.useRef)(null),[E,I]=((0,a.useRef)(null),(0,a.useState)({email:"",password:""})),[T,A]=(0,a.useState)({username:"",email:"",password:"",phone:"",display_name:""}),[D,R]=(0,a.useState)(""),[z,P]=(0,a.useState)([]),[B,O]=(0,a.useState)(!1),[U,Y]=(0,a.useState)({email:"",contact_name:""}),[Q,H]=(0,a.useState)(!1),[F,J]=(0,a.useState)({name:"",description:"",members:[],chat_type:"group"}),[G,Z]=(0,a.useState)([]),[V,W]=(0,a.useState)(!1),[q,X]=(0,a.useState)(!1),[K,$]=(0,a.useState)([]),[ee,te]=(0,a.useState)(!1),[ne,ae]=(0,a.useState)(!1),[re,ie]=(0,a.useState)({user_id:"",reason:"",description:"",message_id:null,chat_id:null}),[fe,oe]=(0,a.useState)(!1),[se,le]=(0,a.useState)(!1),[ue,ce]=(0,a.useState)(!1),[de,he]=(0,a.useState)(!1),[pe,ge]=(0,a.useState)(0),[me,be]=(0,a.useState)(null),[we,ye]=(0,a.useState)(null),[ve,_e]=(0,a.useState)("idle"),[Me,Le]=(0,a.useState)([]),[Ce,je]=(0,a.useState)(null),[xe,Se]=(0,a.useState)(null),[ke,Ne]=(0,a.useState)(""),[Ee,Ie]=(0,a.useState)([]),[Te,Ae]=(0,a.useState)(!1),[De,Re]=(0,a.useState)({content:"",media_type:"text",background_color:"#000000",text_color:"#ffffff",privacy:"all"}),[ze,Pe]=(0,a.useState)(null),[Be,Oe]=(0,a.useState)([]),[Ue,Ye]=(0,a.useState)(!1),[Qe,He]=(0,a.useState)({name:"",description:"",is_public:!0,category:"general"}),[Fe,Je]=(0,a.useState)([]),[Ge,Ze]=(0,a.useState)(null),[Ve,We]=(0,a.useState)(!1),[qe,Xe]=(0,a.useState)({name:"",description:"",max_participants:50}),[Ke,$e]=(0,a.useState)([]),[et,tt]=(0,a.useState)([]),[nt,at]=(0,a.useState)(!1),[rt,it]=(0,a.useState)("users"),[ft,ot]=(0,a.useState)(!1),[st,lt]=(0,a.useState)({profile_photo:"everyone",last_seen:"everyone",phone_number:"contacts",read_receipts:!0,typing_indicators:!0}),[ut,ct]=(0,a.useState)(!1),[dt,ht]=(0,a.useState)(null),[pt,gt]=(0,a.useState)(null),[mt,bt]=(0,a.useState)(!1),[wt,yt]=(0,a.useState)([]),[vt,_t]=(0,a.useState)({activity_status:"online",custom_status:"",game_activity:""}),[Mt,Lt]=(0,a.useState)({bio:"",location:"",website:"",interests:[],languages:[]}),[Ct,jt]=(0,a.useState)(!1),[xt,St]=(0,a.useState)(!1),[kt,Nt]=(0,a.useState)({question:"",options:["",""],is_anonymous:!1,allows_multiple_answers:!1,expires_in_hours:null}),[Et,It]=(0,a.useState)(!1),[Tt,Dt]=(0,a.useState)(null);(0,a.useEffect)((()=>{if(u&&!C){const e=gs.replace("https:","wss:").replace("http:","ws:"),t=new WebSocket("".concat(e,"/api/ws/").concat(u.user_id));t.onopen=()=>{console.log("WebSocket connected"),S(!0),t.send(JSON.stringify({type:"user_status",status:vt.activity_status,activity:vt.custom_status,game:vt.game_activity}))},t.onmessage=e=>{const t=JSON.parse(e.data);switch(console.log("WebSocket message:",t),t.type){case"new_message":y((e=>[...e,t.data])),Ot();break;case"message_read":y((e=>e.map((e=>e.message_id===t.data.message_id?l(l({},e),{},{read_status:"read"}):e))));break;case"message_reaction":y((e=>e.map((e=>e.message_id===t.data.message_id?l(l({},e),{},{reactions:t.data.reactions}):e))));break;case"message_edited":y((e=>e.map((e=>e.message_id===t.data.message_id?l(l({},e),{},{content:t.data.new_content,edited_at:t.data.edited_at}):e))));break;case"message_deleted":y((e=>e.map((e=>e.message_id===t.data.message_id?l(l({},e),{},{is_deleted:!0,content:"[This message was deleted]"}):e))));break;case"typing_status":Le(t.data.typing_users.filter((e=>e!==u.user_id)));break;case"incoming_call":le(!0),_e("incoming");break;case"user_joined_voice":Ft();break;case"status_update":console.log("Status update:",t.data);break;case"screen_share_toggle":console.log("Screen share toggled:",t.data)}},t.onclose=()=>{console.log("WebSocket disconnected"),S(!1)},t.onerror=e=>{console.error("WebSocket error:",e)},j(t)}return()=>{C&&C.close()}}),[u]),(0,a.useEffect)((()=>{Rt()}),[w]),(0,a.useEffect)((()=>{let e;return de?e=setInterval((()=>{ge((e=>e+1))}),1e3):ge(0),()=>clearInterval(e)}),[de]),(0,a.useEffect)((()=>{if(v&&m&&C){C.send(JSON.stringify({type:"typing",chat_id:m.chat_id,is_typing:!0}));const e=setTimeout((()=>{C.send(JSON.stringify({type:"typing",chat_id:m.chat_id,is_typing:!1}))}),2e3);return()=>clearTimeout(e)}}),[v,m,C]);const Rt=()=>{var e;null===(e=k.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},zt=async e=>{e.preventDefault();try{const e=await At.post("".concat(ms,"/login"),E),{access_token:t,user:n}=e.data;h(t),c(n),lt(n.privacy_settings||st),localStorage.setItem("token",t),s("chat"),setTimeout((()=>{Ot(t),Ut(t),Yt(t),Qt(t),Ht(t),Ft(t)}),100)}catch(a){var t,n;console.error("Login error:",a),alert("Login failed: "+((null===(t=a.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.detail)||a.message))}},Pt=async e=>{e.preventDefault();try{const e=await At.post("".concat(ms,"/register"),T),{access_token:t,user:n}=e.data;h(t),c(n),localStorage.setItem("token",t),s("chat"),n.backup_phrase&&alert("IMPORTANT: Save your backup phrase securely:\n\n".concat(n.backup_phrase,"\n\nThis phrase can recover your account if you lose access.")),setTimeout((()=>{Ot(t),Ut(t),Yt(t),Qt(t),Ht(t),Ft(t)}),100)}catch(a){var t,n;console.error("Registration error:",a),alert("Registration failed: "+((null===(t=a.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.detail)||a.message))}},Bt=function(){return{headers:{Authorization:"Bearer ".concat((arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||d)}}},Ot=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=await At.get("".concat(ms,"/chats"),Bt(e));g(t.data)}catch(t){console.error("Error fetching chats:",t)}},Ut=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=await At.get("".concat(ms,"/contacts"),Bt(e));L(t.data)}catch(t){console.error("Error fetching contacts:",t)}},Yt=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=await At.get("".concat(ms,"/users/blocked"),Bt(e));$(t.data)}catch(t){console.error("Error fetching blocked users:",t)}},Qt=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=await At.get("".concat(ms,"/stories"),Bt(e));Ie(t.data)}catch(t){console.error("Error fetching stories:",t)}},Ht=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=await At.get("".concat(ms,"/channels"),Bt(e));Oe(t.data)}catch(t){console.error("Error fetching channels:",t)}},Ft=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=await At.get("".concat(ms,"/voice/rooms"),Bt(e));Je(t.data)}catch(t){console.error("Error fetching voice rooms:",t)}},Jt=async e=>{try{await At.post("".concat(ms,"/messages/read"),{message_ids:e},Bt())}catch(t){console.error("Error marking messages as read:",t)}},Gt=async(e,t)=>{try{await At.put("".concat(ms,"/messages/edit"),{message_id:e,new_content:t},Bt()),Se(null),Ne("")}catch(n){console.error("Error editing message:",n)}},Zt=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"voice";try{await At.post("".concat(ms,"/calls/initiate"),{chat_id:m.chat_id,call_type:e,screen_sharing:!1},Bt());_e("calling"),"video"===e?ce(!0):le(!0);const t=await navigator.mediaDevices.getUserMedia({video:"video"===e,audio:!0});ye(t);const n=new(Of())({initiator:!0,trickle:!1,stream:t});be(n)}catch(t){console.error("Error initiating call:",t)}},Vt=async()=>{try{await At.post("".concat(ms,"/polls"),l(l({},kt),{},{chat_id:m.chat_id}),Bt()),St(!1),Nt({question:"",options:["",""],is_anonymous:!1,allows_multiple_answers:!1,expires_in_hours:null})}catch(e){console.error("Error creating poll:",e)}},Wt=e=>{b(e),(async e=>{try{const t=await At.get("".concat(ms,"/chats/").concat(e,"/messages"),Bt());y(t.data);const n=t.data.filter((e=>e.sender_id!==u.user_id&&"unread"===e.read_status));n.length>0&&Jt(n.map((e=>e.message_id)))}catch(t){console.error("Error fetching messages:",t)}})(e.chat_id)},qt=e=>new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),Xt=e=>e.sender_id!==u.user_id?null:"read"===e.read_status?(0,cs.jsx)("span",{className:"text-blue-400 ml-1",children:"\u2713\u2713"}):(0,cs.jsx)("span",{className:"text-gray-400 ml-1",children:"\u2713\u2713"});return"login"===o?(0,cs.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 flex items-center justify-center p-4",children:(0,cs.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-3xl shadow-2xl p-8 w-full max-w-md border border-white/20",children:[(0,cs.jsxs)("div",{className:"text-center mb-8",children:[(0,cs.jsx)("div",{className:"text-8xl mb-4",children:"\ud83d\ude80"}),(0,cs.jsxs)("h1",{className:"text-4xl font-bold text-white mb-2",children:["ChatApp Pro",(0,cs.jsx)("span",{className:"text-2xl ml-2",children:"Ultimate"})]}),(0,cs.jsx)("p",{className:"text-gray-200",children:"The Ultimate Communication Platform"}),(0,cs.jsxs)("div",{className:"flex flex-wrap justify-center gap-2 mt-3 text-xs text-gray-300",children:[(0,cs.jsx)("span",{className:"bg-white/20 px-2 py-1 rounded-full",children:"\ud83d\udd12 Encryption"}),(0,cs.jsx)("span",{className:"bg-white/20 px-2 py-1 rounded-full",children:"\ud83d\udcde Calls"}),(0,cs.jsx)("span",{className:"bg-white/20 px-2 py-1 rounded-full",children:"\ud83d\udcd6 Stories"}),(0,cs.jsx)("span",{className:"bg-white/20 px-2 py-1 rounded-full",children:"\ud83d\udce2 Channels"}),(0,cs.jsx)("span",{className:"bg-white/20 px-2 py-1 rounded-full",children:"\ud83c\udfa4 Voice Rooms"}),(0,cs.jsx)("span",{className:"bg-white/20 px-2 py-1 rounded-full",children:"\ud83d\udd0d Discovery"})]})]}),(0,cs.jsxs)("div",{className:"flex mb-6",children:[(0,cs.jsx)("button",{onClick:()=>s("login"),className:"flex-1 py-3 px-4 rounded-l-xl font-medium transition-all ".concat("login"===o?"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg":"bg-white/20 text-gray-200 hover:bg-white/30"),children:"Login"}),(0,cs.jsx)("button",{onClick:()=>s("register"),className:"flex-1 py-3 px-4 rounded-r-xl font-medium transition-all ".concat("register"===o?"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg":"bg-white/20 text-gray-200 hover:bg-white/30"),children:"Register"})]}),(0,cs.jsxs)("form",{onSubmit:zt,className:"space-y-4",children:[(0,cs.jsx)("div",{children:(0,cs.jsx)("input",{type:"email",placeholder:"Email",className:"w-full p-4 bg-white/20 border border-white/30 rounded-xl text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white/30 transition-all",value:E.email,onChange:e=>I(l(l({},E),{},{email:e.target.value})),required:!0})}),(0,cs.jsx)("div",{children:(0,cs.jsx)("input",{type:"password",placeholder:"Password",className:"w-full p-4 bg-white/20 border border-white/30 rounded-xl text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white/30 transition-all",value:E.password,onChange:e=>I(l(l({},E),{},{password:e.target.value})),required:!0})}),(0,cs.jsx)("button",{type:"submit",className:"w-full bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 text-white py-4 rounded-xl font-medium hover:shadow-2xl hover:scale-105 transition-all duration-300",children:"\ud83d\ude80 Launch ChatApp Pro"})]})]})}):"register"===o?(0,cs.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 flex items-center justify-center p-4",children:(0,cs.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-3xl shadow-2xl p-8 w-full max-w-md border border-white/20",children:[(0,cs.jsxs)("div",{className:"text-center mb-8",children:[(0,cs.jsx)("div",{className:"text-8xl mb-4",children:"\ud83d\ude80"}),(0,cs.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"Join ChatApp Pro"}),(0,cs.jsx)("p",{className:"text-gray-200",children:"Create your ultimate account"})]}),(0,cs.jsxs)("div",{className:"flex mb-6",children:[(0,cs.jsx)("button",{onClick:()=>s("login"),className:"flex-1 py-3 px-4 rounded-l-xl font-medium transition-all ".concat("login"===o?"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg":"bg-white/20 text-gray-200 hover:bg-white/30"),children:"Login"}),(0,cs.jsx)("button",{onClick:()=>s("register"),className:"flex-1 py-3 px-4 rounded-r-xl font-medium transition-all ".concat("register"===o?"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg":"bg-white/20 text-gray-200 hover:bg-white/30"),children:"Register"})]}),(0,cs.jsxs)("form",{onSubmit:Pt,className:"space-y-4",children:[(0,cs.jsx)("div",{children:(0,cs.jsx)("input",{type:"text",placeholder:"Username",className:"w-full p-4 bg-white/20 border border-white/30 rounded-xl text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white/30 transition-all",value:T.username,onChange:e=>A(l(l({},T),{},{username:e.target.value})),required:!0})}),(0,cs.jsx)("div",{children:(0,cs.jsx)("input",{type:"text",placeholder:"Display Name (optional)",className:"w-full p-4 bg-white/20 border border-white/30 rounded-xl text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white/30 transition-all",value:T.display_name,onChange:e=>A(l(l({},T),{},{display_name:e.target.value}))})}),(0,cs.jsx)("div",{children:(0,cs.jsx)("input",{type:"email",placeholder:"Email",className:"w-full p-4 bg-white/20 border border-white/30 rounded-xl text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white/30 transition-all",value:T.email,onChange:e=>A(l(l({},T),{},{email:e.target.value})),required:!0})}),(0,cs.jsx)("div",{children:(0,cs.jsx)("input",{type:"tel",placeholder:"Phone (optional)",className:"w-full p-4 bg-white/20 border border-white/30 rounded-xl text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white/30 transition-all",value:T.phone,onChange:e=>A(l(l({},T),{},{phone:e.target.value}))})}),(0,cs.jsx)("div",{children:(0,cs.jsx)("input",{type:"password",placeholder:"Password",className:"w-full p-4 bg-white/20 border border-white/30 rounded-xl text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white/30 transition-all",value:T.password,onChange:e=>A(l(l({},T),{},{password:e.target.value})),required:!0})}),(0,cs.jsx)("button",{type:"submit",className:"w-full bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 text-white py-4 rounded-xl font-medium hover:shadow-2xl hover:scale-105 transition-all duration-300",children:"\ud83d\ude80 Create Ultimate Account"})]})]})}):(0,cs.jsxs)("div",{className:"h-screen flex bg-gradient-to-br from-gray-50 to-blue-50",children:[(0,cs.jsxs)("div",{className:"w-1/3 bg-white/80 backdrop-blur-lg border-r border-gray-200/50 flex flex-col shadow-xl",children:[(0,cs.jsx)("div",{className:"p-4 bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 text-white",children:(0,cs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,cs.jsxs)("div",{className:"flex items-center",children:[(0,cs.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-400 to-purple-400 rounded-full flex items-center justify-center shadow-lg",children:(0,cs.jsx)("span",{className:"font-bold text-lg",children:u.username.charAt(0).toUpperCase()})}),(0,cs.jsxs)("div",{className:"ml-3",children:[(0,cs.jsxs)("p",{className:"font-medium text-lg",children:[u.display_name||u.username," \ud83d\ude80"]}),(0,cs.jsx)("p",{className:"text-xs text-blue-200",children:x?"Ultimate Mode Active":"Connecting..."})]})]}),(0,cs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,cs.jsx)("button",{onClick:()=>at(!nt),className:"text-blue-200 hover:text-white p-2 rounded-lg hover:bg-white/20 transition-all",title:"Discover",children:"\ud83d\udd0d"}),(0,cs.jsx)("button",{onClick:()=>ot(!ft),className:"text-blue-200 hover:text-white p-2 rounded-lg hover:bg-white/20 transition-all",title:"Privacy",children:"\ud83d\udee1\ufe0f"}),(0,cs.jsx)("button",{onClick:()=>bt(!mt),className:"text-blue-200 hover:text-white p-2 rounded-lg hover:bg-white/20 transition-all",title:"Backup",children:"\ud83d\udcbe"}),(0,cs.jsx)("button",{onClick:()=>jt(!Ct),className:"text-blue-200 hover:text-white p-2 rounded-lg hover:bg-white/20 transition-all",title:"Profile",children:"\ud83d\udc64"}),(0,cs.jsx)("button",{onClick:()=>{h(null),c(null),g([]),b(null),y([]),L([]),$([]),Ie([]),Oe([]),Je([]),localStorage.removeItem("token"),C&&(C.close(),j(null)),we&&we.getTracks().forEach((e=>e.stop())),Tt&&Tt.getTracks().forEach((e=>e.stop())),s("login")},className:"text-blue-200 hover:text-white p-2 rounded-lg hover:bg-white/20 transition-all",title:"Logout",children:(0,cs.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,cs.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})})]})]})}),Ee.length>0&&(0,cs.jsx)("div",{className:"p-3 border-b border-gray-200/50",children:(0,cs.jsx)("div",{className:"flex space-x-3 overflow-x-auto scrollbar-hide",children:Ee.map((e=>(0,cs.jsxs)("div",{className:"flex-shrink-0 text-center cursor-pointer group",onClick:()=>Pe(e),children:[(0,cs.jsx)("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full p-0.5 group-hover:scale-110 transition-transform",children:(0,cs.jsx)("div",{className:"w-full h-full bg-gray-300 rounded-full flex items-center justify-center text-white font-bold",children:e.user.username.charAt(0).toUpperCase()})}),(0,cs.jsx)("p",{className:"text-xs mt-1 truncate w-14 font-medium",children:e.user.username})]},e.user.user_id)))})}),Fe.length>0&&(0,cs.jsxs)("div",{className:"p-3 border-b border-gray-200/50",children:[(0,cs.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"\ud83c\udfa4 Active Voice Rooms"}),(0,cs.jsx)("div",{className:"space-y-2",children:Fe.slice(0,3).map((e=>(0,cs.jsx)("div",{className:"p-2 rounded-lg cursor-pointer transition-all ".concat(Ge===e.room_id?"bg-green-100 border border-green-300":"bg-gray-50 hover:bg-gray-100"),onClick:()=>(async e=>{try{await At.post("".concat(ms,"/voice/rooms/").concat(e,"/join"),{},Bt()),Ze(e),C&&C.send(JSON.stringify({type:"join_voice_room",room_id:e}))}catch(t){console.error("Error joining voice room:",t)}})(e.room_id),children:(0,cs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,cs.jsxs)("div",{children:[(0,cs.jsx)("p",{className:"font-medium text-sm",children:e.name}),(0,cs.jsxs)("p",{className:"text-xs text-gray-500",children:[e.participant_count,"/",e.max_participants," users"]})]}),(0,cs.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"})]})},e.room_id)))})]}),(0,cs.jsx)("div",{className:"p-3",children:(0,cs.jsx)("input",{type:"text",placeholder:"Search everything... \ud83d\udd0d",className:"w-full p-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white/50 backdrop-blur-sm",value:D,onChange:e=>{R(e.target.value)}})}),(0,cs.jsxs)("div",{className:"px-3 pb-3 grid grid-cols-3 gap-2",children:[(0,cs.jsxs)("button",{onClick:()=>O(!0),className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white py-2 rounded-lg text-xs hover:shadow-lg transition-all flex flex-col items-center",children:[(0,cs.jsx)("span",{className:"text-lg",children:"\ud83d\udc65"}),(0,cs.jsx)("span",{children:"Add"})]}),(0,cs.jsxs)("button",{onClick:()=>H(!0),className:"bg-gradient-to-r from-purple-500 to-violet-500 text-white py-2 rounded-lg text-xs hover:shadow-lg transition-all flex flex-col items-center",children:[(0,cs.jsx)("span",{className:"text-lg",children:"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66"}),(0,cs.jsx)("span",{children:"Group"})]}),(0,cs.jsxs)("button",{onClick:()=>Ye(!0),className:"bg-gradient-to-r from-blue-500 to-cyan-500 text-white py-2 rounded-lg text-xs hover:shadow-lg transition-all flex flex-col items-center",children:[(0,cs.jsx)("span",{className:"text-lg",children:"\ud83d\udce2"}),(0,cs.jsx)("span",{children:"Channel"})]}),(0,cs.jsxs)("button",{onClick:()=>Ae(!0),className:"bg-gradient-to-r from-pink-500 to-rose-500 text-white py-2 rounded-lg text-xs hover:shadow-lg transition-all flex flex-col items-center",children:[(0,cs.jsx)("span",{className:"text-lg",children:"\ud83d\udcd6"}),(0,cs.jsx)("span",{children:"Story"})]}),(0,cs.jsxs)("button",{onClick:()=>We(!0),className:"bg-gradient-to-r from-orange-500 to-red-500 text-white py-2 rounded-lg text-xs hover:shadow-lg transition-all flex flex-col items-center",children:[(0,cs.jsx)("span",{className:"text-lg",children:"\ud83c\udfa4"}),(0,cs.jsx)("span",{children:"Voice"})]}),(0,cs.jsxs)("button",{onClick:()=>St(!0),className:"bg-gradient-to-r from-indigo-500 to-purple-500 text-white py-2 rounded-lg text-xs hover:shadow-lg transition-all flex flex-col items-center",children:[(0,cs.jsx)("span",{className:"text-lg",children:"\ud83d\udcca"}),(0,cs.jsx)("span",{children:"Poll"})]})]}),(0,cs.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===p.length?(0,cs.jsxs)("div",{className:"p-6 text-center text-gray-500",children:[(0,cs.jsx)("div",{className:"text-8xl mb-4",children:"\ud83d\ude80"}),(0,cs.jsx)("p",{className:"font-medium text-lg mb-2",children:"Welcome to ChatApp Pro Ultimate!"}),(0,cs.jsx)("p",{className:"text-sm",children:"Create your first chat, story, channel, or voice room"}),(0,cs.jsxs)("div",{className:"mt-4 text-xs space-y-1",children:[(0,cs.jsxs)("div",{className:"flex items-center justify-center",children:[(0,cs.jsx)("span",{className:"mr-2",children:"\ud83d\udd12"}),(0,cs.jsx)("span",{children:"End-to-end encryption"})]}),(0,cs.jsxs)("div",{className:"flex items-center justify-center",children:[(0,cs.jsx)("span",{className:"mr-2",children:"\ud83c\udfa5"}),(0,cs.jsx)("span",{children:"Video calls & screen sharing"})]}),(0,cs.jsxs)("div",{className:"flex items-center justify-center",children:[(0,cs.jsx)("span",{className:"mr-2",children:"\ud83c\udf10"}),(0,cs.jsx)("span",{children:"Global discovery & channels"})]})]})]}):p.map((e=>{var t,n,a,r,i,f,o;return(0,cs.jsx)("div",{className:"p-4 border-b border-gray-100/50 cursor-pointer transition-all duration-200 ".concat((null===m||void 0===m?void 0:m.chat_id)===e.chat_id?"bg-gradient-to-r from-purple-100 to-blue-100 border-purple-200 shadow-lg":"hover:bg-gradient-to-r hover:from-gray-50 hover:to-blue-50"),onClick:()=>Wt(e),children:(0,cs.jsxs)("div",{className:"flex items-center",children:[(0,cs.jsxs)("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-400 to-purple-400 rounded-full flex items-center justify-center relative shadow-lg",children:[(0,cs.jsx)("span",{className:"text-white font-medium text-lg",children:"direct"===e.chat_type?(null===(t=e.other_user)||void 0===t||null===(n=t.username)||void 0===n?void 0:n.charAt(0).toUpperCase())||"?":(null===(a=e.name)||void 0===a?void 0:a.charAt(0).toUpperCase())||"G"}),(null===(r=e.other_user)||void 0===r?void 0:r.is_online)&&(0,cs.jsx)("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-green-400 rounded-full border-2 border-white animate-pulse"})]}),(0,cs.jsxs)("div",{className:"ml-4 flex-1",children:[(0,cs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,cs.jsx)("p",{className:"font-medium text-gray-800",children:"direct"===e.chat_type?(null===(i=e.other_user)||void 0===i?void 0:i.username)||"Unknown User":e.name}),e.last_message&&(0,cs.jsx)("span",{className:"text-xs text-gray-500",children:qt(e.last_message.timestamp)})]}),e.last_message&&(0,cs.jsxs)("p",{className:"text-sm text-gray-600 truncate",children:["\ud83d\udd12 ",e.last_message.content]}),Me.length>0&&(null===m||void 0===m?void 0:m.chat_id)===e.chat_id&&(0,cs.jsxs)("div",{className:"flex items-center mt-1",children:[(0,cs.jsxs)("div",{className:"flex space-x-1",children:[(0,cs.jsx)("div",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce"}),(0,cs.jsx)("div",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,cs.jsx)("div",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),(0,cs.jsx)("p",{className:"text-xs text-purple-500 italic ml-2",children:"typing..."})]}),(0,cs.jsxs)("div",{className:"flex items-center justify-between mt-1",children:["direct"===e.chat_type&&(null===(f=e.other_user)||void 0===f?void 0:f.is_online)&&(0,cs.jsx)("span",{className:"text-xs text-green-500 font-medium",children:"\u25cf Online"}),"group"===e.chat_type&&(0,cs.jsxs)("span",{className:"text-xs text-gray-500",children:["\ud83d\udc65 ",(null===(o=e.members)||void 0===o?void 0:o.length)||0," members"]}),"channel"===e.chat_type&&(0,cs.jsx)("span",{className:"text-xs text-blue-500",children:"\ud83d\udce2 Channel"})]})]})]})},e.chat_id)}))})]}),(0,cs.jsx)("div",{className:"flex-1 flex flex-col",children:m?(0,cs.jsxs)(cs.Fragment,{children:[(0,cs.jsx)("div",{className:"p-4 bg-white/80 backdrop-blur-lg border-b border-gray-200/50 shadow-sm",children:(0,cs.jsxs)("div",{className:"flex items-center justify-between",children:[(0,cs.jsxs)("div",{className:"flex items-center",children:[(0,cs.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-400 to-purple-400 rounded-full flex items-center justify-center shadow-lg",children:(0,cs.jsx)("span",{className:"text-white font-medium",children:"direct"===m.chat_type?(null===(e=m.other_user)||void 0===e||null===(t=e.username)||void 0===t?void 0:t.charAt(0).toUpperCase())||"?":(null===(n=m.name)||void 0===n?void 0:n.charAt(0).toUpperCase())||"G"})}),(0,cs.jsxs)("div",{className:"ml-4",children:[(0,cs.jsxs)("p",{className:"font-medium text-lg flex items-center",children:["direct"===m.chat_type?(null===(r=m.other_user)||void 0===r?void 0:r.username)||"Unknown User":m.name,(0,cs.jsx)("span",{className:"ml-2 text-purple-500",children:"\ud83d\ude80"})]}),(0,cs.jsxs)("p",{className:"text-sm text-gray-500",children:["direct"===m.chat_type&&(null===(i=m.other_user)||void 0===i?void 0:i.is_online)&&(0,cs.jsx)("span",{className:"text-green-500",children:"\u25cf Online"}),"group"===m.chat_type&&(0,cs.jsxs)("span",{children:["\ud83d\udc65 ",(null===(f=m.members)||void 0===f?void 0:f.length)||0," members"]}),(0,cs.jsx)("span",{className:"ml-2",children:"\u2022 End-to-end encrypted \u2022 Ultimate Security"})]})]})]}),(0,cs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,cs.jsx)("button",{onClick:()=>Zt("voice"),className:"p-3 text-gray-600 hover:text-green-600 hover:bg-green-50 rounded-xl transition-all hover:scale-110",title:"Voice Call",children:(0,cs.jsx)("span",{className:"text-xl",children:"\ud83d\udcde"})}),(0,cs.jsx)("button",{onClick:()=>Zt("video"),className:"p-3 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-xl transition-all hover:scale-110",title:"Video Call",children:(0,cs.jsx)("span",{className:"text-xl",children:"\ud83d\udcf9"})}),(0,cs.jsx)("button",{onClick:Et?async()=>{Tt&&(Tt.getTracks().forEach((e=>e.stop())),Dt(null),It(!1),m&&await At.post("".concat(ms,"/calls/").concat(m.call_id,"/screen-share"),{enable:!1},Bt()))}:async()=>{try{const e=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0});Dt(e),It(!0),m&&await At.post("".concat(ms,"/calls/").concat(m.call_id,"/screen-share"),{enable:!0},Bt())}catch(e){console.error("Error starting screen share:",e)}},className:"p-3 rounded-xl transition-all hover:scale-110 ".concat(Et?"text-red-600 bg-red-50":"text-gray-600 hover:text-purple-600 hover:bg-purple-50"),title:Et?"Stop Screen Share":"Start Screen Share",children:(0,cs.jsx)("span",{className:"text-xl",children:"\ud83d\udda5\ufe0f"})}),(0,cs.jsx)("button",{onClick:()=>{var e;return null===(e=N.current)||void 0===e?void 0:e.click()},className:"p-3 text-gray-600 hover:text-purple-600 hover:bg-purple-50 rounded-xl transition-all hover:scale-110",title:"Attach File",children:(0,cs.jsx)("span",{className:"text-xl",children:"\ud83d\udcce"})}),"direct"===m.chat_type&&(0,cs.jsx)("button",{onClick:()=>{var e;return(async e=>{try{const t=await At.get("".concat(ms,"/safety/number/").concat(e),Bt());ht(t.data),gt(e),ct(!0)}catch(t){console.error("Error getting safety number:",t)}})(null===(e=m.other_user)||void 0===e?void 0:e.user_id)},className:"p-3 text-gray-600 hover:text-indigo-600 hover:bg-indigo-50 rounded-xl transition-all hover:scale-110",title:"Safety Number",children:(0,cs.jsx)("span",{className:"text-xl",children:"\ud83d\udee1\ufe0f"})}),(0,cs.jsx)("input",{ref:N,type:"file",hidden:!0,onChange:e=>{var t;null!==(t=e.target.files)&&void 0!==t&&t[0]}})]})]})}),(0,cs.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 bg-gradient-to-b from-gray-50/50 to-white/50 backdrop-blur-sm",children:[Ce&&(0,cs.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-4 rounded-xl border border-blue-200 mb-4 backdrop-blur-sm",children:(0,cs.jsxs)("div",{className:"flex justify-between items-center",children:[(0,cs.jsxs)("div",{children:[(0,cs.jsx)("p",{className:"text-sm text-blue-600 font-medium",children:"\u21a9\ufe0f Replying to:"}),(0,cs.jsx)("p",{className:"text-sm text-gray-700 mt-1",children:Ce.content})]}),(0,cs.jsx)("button",{onClick:()=>je(null),className:"text-gray-400 hover:text-gray-600 text-xl",children:"\u2715"})]})}),Et&&(0,cs.jsx)("div",{className:"bg-gradient-to-r from-purple-100 to-blue-100 p-4 rounded-xl border border-purple-200 mb-4",children:(0,cs.jsxs)("div",{className:"flex items-center justify-center",children:[(0,cs.jsx)("span",{className:"text-2xl mr-2",children:"\ud83d\udda5\ufe0f"}),(0,cs.jsx)("p",{className:"text-purple-700 font-medium",children:"You are sharing your screen"})]})}),w.map((e=>{const t=xe===e.message_id;return(0,cs.jsx)("div",{className:"flex ".concat(e.sender_id===u.user_id?"justify-end":"justify-start"," group mb-4"),children:(0,cs.jsxs)("div",{className:"max-w-xs lg:max-w-md px-4 py-3 rounded-2xl relative ".concat(e.sender_id===u.user_id?"bg-gradient-to-r from-blue-600 to-purple-600 text-white":"bg-white text-gray-800 shadow-lg border"," ").concat(e.is_deleted?"opacity-50 italic":""),children:[e.reply_to&&(0,cs.jsx)("div",{className:"text-xs opacity-75 border-l-2 border-current pl-2 mb-2",children:(0,cs.jsx)("span",{className:"text-xs",children:"\u21a9\ufe0f Replying to previous message"})}),e.sender_id!==u.user_id&&"group"===(null===m||void 0===m?void 0:m.chat_type)&&(0,cs.jsx)("p",{className:"text-xs font-medium mb-1 opacity-75",children:e.sender_name}),t?(0,cs.jsxs)("div",{children:[(0,cs.jsx)("input",{type:"text",value:ke,onChange:e=>Ne(e.target.value),className:"w-full bg-transparent border-b text-current p-1",onKeyPress:t=>{"Enter"===t.key&&Gt(e.message_id,ke)},autoFocus:!0}),(0,cs.jsxs)("div",{className:"flex space-x-2 mt-2",children:[(0,cs.jsx)("button",{onClick:()=>Gt(e.message_id,ke),className:"text-xs px-2 py-1 bg-green-500 text-white rounded",children:"Save"}),(0,cs.jsx)("button",{onClick:()=>{Se(null),Ne("")},className:"text-xs px-2 py-1 bg-red-500 text-white rounded",children:"Cancel"})]})]}):(0,cs.jsxs)(cs.Fragment,{children:["voice"===e.message_type?(0,cs.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,cs.jsx)("div",{className:"w-8 h-8 bg-current bg-opacity-20 rounded-full flex items-center justify-center",children:(0,cs.jsx)("span",{className:"text-lg",children:"\ud83c\udfa4"})}),(0,cs.jsxs)("div",{className:"flex-1",children:[(0,cs.jsx)("p",{className:"font-medium",children:"Voice message"}),(0,cs.jsxs)("p",{className:"text-xs opacity-75",children:[e.voice_duration,"s"]}),e.file_data&&(0,cs.jsx)("audio",{controls:!0,className:"mt-2 w-full",children:(0,cs.jsx)("source",{src:"data:audio/mp3;base64,".concat(e.file_data),type:"audio/mp3"})})]})]}):"image"===e.message_type&&e.file_data?(0,cs.jsxs)("div",{children:[(0,cs.jsx)("img",{src:"data:image/jpeg;base64,".concat(e.file_data),alt:e.file_name,className:"max-w-full max-h-64 rounded-lg cursor-pointer transition-transform hover:scale-105",onClick:()=>window.open("data:image/jpeg;base64,".concat(e.file_data),"_blank")}),e.content&&(0,cs.jsx)("p",{className:"mt-2",children:e.content})]}):"file"===e.message_type?(0,cs.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-current bg-opacity-10 rounded-lg",children:[(0,cs.jsx)("span",{className:"text-2xl",children:"\ud83d\udcce"}),(0,cs.jsxs)("div",{className:"flex-1",children:[(0,cs.jsx)("p",{className:"font-medium",children:e.file_name}),(0,cs.jsx)("p",{className:"text-xs opacity-75",children:e.file_size?"".concat((e.file_size/1024).toFixed(1)," KB"):"File"})]})]}):(0,cs.jsx)("p",{className:"leading-relaxed",children:e.content}),e.reactions&&Object.keys(e.reactions).length>0&&(0,cs.jsx)("div",{className:"flex flex-wrap gap-1 mt-3",children:Object.entries(e.reactions).map((t=>{let[n,a]=t;return(0,cs.jsxs)("button",{onClick:()=>(async(e,t)=>{try{await At.post("".concat(ms,"/messages/react"),{message_id:e,emoji:t},Bt())}catch(n){console.error("Error reacting to message:",n)}})(e.message_id,n),className:"px-2 py-1 rounded-full text-xs flex items-center space-x-1 transition-all hover:scale-110 ".concat(a.includes(u.user_id)?"bg-blue-100 text-blue-800 border border-blue-300":"bg-gray-100 text-gray-600 border border-gray-300"),children:[(0,cs.jsx)("span",{children:n}),(0,cs.jsx)("span",{className:"font-medium",children:a.length})]},n)}))}),(0,cs.jsxs)("div",{className:"opacity-0 group-hover:opacity-100 absolute -right-2 -top-2 flex space-x-1 transition-opacity",children:[(0,cs.jsx)("button",{onClick:()=>oe(e.message_id),className:"bg-gray-600 text-white rounded-full w-7 h-7 flex items-center justify-center text-xs hover:bg-gray-700 transition-colors",title:"React",children:"\ud83d\ude0a"}),(0,cs.jsx)("button",{onClick:()=>je(e),className:"bg-blue-600 text-white rounded-full w-7 h-7 flex items-center justify-center text-xs hover:bg-blue-700 transition-colors",title:"Reply",children:"\u21a9\ufe0f"}),e.sender_id===u.user_id&&(0,cs.jsxs)(cs.Fragment,{children:[(0,cs.jsx)("button",{onClick:()=>{Se(e.message_id),Ne(e.content)},className:"bg-yellow-600 text-white rounded-full w-7 h-7 flex items-center justify-center text-xs hover:bg-yellow-700 transition-colors",title:"Edit",children:"\u270f\ufe0f"}),(0,cs.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this message?"))try{await At.delete("".concat(ms,"/messages/").concat(e),Bt())}catch(t){console.error("Error deleting message:",t)}})(e.message_id),className:"bg-red-600 text-white rounded-full w-7 h-7 flex items-center justify-center text-xs hover:bg-red-700 transition-colors",title:"Delete",children:"\ud83d\uddd1\ufe0f"})]})]})]}),(0,cs.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,cs.jsxs)("p",{className:"text-xs opacity-75",children:[qt(e.timestamp),e.edited_at&&(0,cs.jsx)("span",{className:"ml-1",children:"(edited)"}),e.is_encrypted&&(0,cs.jsx)("span",{className:"ml-1",children:"\ud83d\udd12"})]}),Xt(e)]})]})},e.message_id)})),(0,cs.jsx)("div",{ref:k})]}),(0,cs.jsxs)("div",{className:"p-6 bg-white/80 backdrop-blur-lg border-t border-gray-200/50",children:[(0,cs.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(v.trim()||Ce)&&m)try{const e={content:v,message_type:"text"};Ce&&(e.reply_to=Ce.message_id),await At.post("".concat(ms,"/chats/").concat(m.chat_id,"/messages"),e,Bt()),_(""),je(null)}catch(n){var t;console.error("Error sending message:",n),403===(null===(t=n.response)||void 0===t?void 0:t.status)&&alert("Cannot send message to blocked user")}},className:"flex items-center space-x-3",children:[(0,cs.jsx)("button",{type:"button",onClick:de?async()=>{try{const[e,t]=await bs.stop().getMp3();he(!1);const n=new FileReader;n.onload=async()=>{const e=n.result.split(",")[1];try{await At.post("".concat(ms,"/chats/").concat(m.chat_id,"/messages"),{content:"Voice message (".concat(pe,"s)"),message_type:"voice",file_data:e,voice_duration:pe,file_name:"voice_message.mp3"},Bt())}catch(t){console.error("Error sending voice message:",t)}},n.readAsDataURL(t)}catch(e){console.error("Error stopping recording:",e)}}:async()=>{try{await bs.start(),he(!0)}catch(e){console.error("Error starting recording:",e),alert("Could not start recording. Please check microphone permissions.")}},className:"p-4 rounded-full transition-all ".concat(de?"bg-red-500 text-white animate-pulse shadow-lg scale-110":"bg-gradient-to-r from-gray-200 to-gray-300 text-gray-600 hover:from-gray-300 hover:to-gray-400 hover:scale-110"),title:de?"Recording... ".concat(pe,"s"):"Voice Message",children:(0,cs.jsx)("span",{className:"text-xl",children:"\ud83c\udfa4"})}),(0,cs.jsxs)("div",{className:"flex-1 relative",children:[(0,cs.jsx)("input",{type:"text",placeholder:"Type your ultimate message... \ud83d\ude80",className:"w-full p-4 pr-16 border border-gray-300 rounded-2xl focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white/80 backdrop-blur-sm shadow-lg transition-all focus:scale-105",value:v,onChange:e=>_(e.target.value),disabled:de}),(0,cs.jsxs)("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 flex space-x-2",children:[(0,cs.jsx)("button",{type:"button",onClick:()=>oe(!fe),className:"text-gray-400 hover:text-gray-600 text-xl transition-all hover:scale-125",children:"\ud83d\ude0a"}),(0,cs.jsx)("button",{type:"button",onClick:()=>St(!0),className:"text-gray-400 hover:text-gray-600 text-xl transition-all hover:scale-125",children:"\ud83d\udcca"})]})]}),(0,cs.jsxs)("button",{type:"submit",className:"bg-gradient-to-r from-purple-600 via-blue-600 to-indigo-600 text-white px-8 py-4 rounded-2xl hover:shadow-2xl hover:scale-110 transition-all duration-300 flex items-center space-x-2",disabled:!v.trim()&&!Ce||de,children:[(0,cs.jsx)("span",{className:"font-medium",children:"Send"}),(0,cs.jsx)("span",{className:"text-lg",children:"\ud83d\ude80"})]})]}),fe&&(0,cs.jsx)("div",{className:"absolute bottom-24 right-8 z-50 shadow-2xl rounded-2xl overflow-hidden",children:(0,cs.jsx)(Pf,{onEmojiClick:e=>{_((t=>t+e.emoji)),oe(!1)}})})]})]}):(0,cs.jsx)("div",{className:"flex-1 flex items-center justify-center bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-50",children:(0,cs.jsxs)("div",{className:"text-center max-w-md",children:[(0,cs.jsx)("div",{className:"text-9xl mb-6 animate-bounce",children:"\ud83d\ude80"}),(0,cs.jsx)("h3",{className:"text-4xl font-bold text-gray-800 mb-4 bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",children:"ChatApp Pro Ultimate"}),(0,cs.jsx)("p",{className:"text-gray-600 mb-8 text-lg",children:"Select a chat to start the ultimate messaging experience"}),(0,cs.jsxs)("div",{className:"grid grid-cols-2 gap-6 text-sm text-gray-500",children:[(0,cs.jsxs)("div",{className:"flex flex-col items-center p-4 bg-white/50 rounded-2xl backdrop-blur-sm",children:[(0,cs.jsx)("span",{className:"text-3xl mb-2",children:"\ud83d\udd12"}),(0,cs.jsx)("span",{className:"font-medium",children:"Military-grade encryption"})]}),(0,cs.jsxs)("div",{className:"flex flex-col items-center p-4 bg-white/50 rounded-2xl backdrop-blur-sm",children:[(0,cs.jsx)("span",{className:"text-3xl mb-2",children:"\ud83d\udcde"}),(0,cs.jsx)("span",{className:"font-medium",children:"HD calls & screen sharing"})]}),(0,cs.jsxs)("div",{className:"flex flex-col items-center p-4 bg-white/50 rounded-2xl backdrop-blur-sm",children:[(0,cs.jsx)("span",{className:"text-3xl mb-2",children:"\ud83d\udcd6"}),(0,cs.jsx)("span",{className:"font-medium",children:"Stories & channels"})]}),(0,cs.jsxs)("div",{className:"flex flex-col items-center p-4 bg-white/50 rounded-2xl backdrop-blur-sm",children:[(0,cs.jsx)("span",{className:"text-3xl mb-2",children:"\ud83c\udfa4"}),(0,cs.jsx)("span",{className:"font-medium",children:"Voice rooms & recording"})]}),(0,cs.jsxs)("div",{className:"flex flex-col items-center p-4 bg-white/50 rounded-2xl backdrop-blur-sm",children:[(0,cs.jsx)("span",{className:"text-3xl mb-2",children:"\ud83d\udd0d"}),(0,cs.jsx)("span",{className:"font-medium",children:"Global discovery"})]}),(0,cs.jsxs)("div",{className:"flex flex-col items-center p-4 bg-white/50 rounded-2xl backdrop-blur-sm",children:[(0,cs.jsx)("span",{className:"text-3xl mb-2",children:"\ud83d\udee1\ufe0f"}),(0,cs.jsx)("span",{className:"font-medium",children:"Advanced privacy"})]})]})]})})}),B&&(0,cs.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,cs.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 max-w-[90vw]",children:[(0,cs.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Add Contact"}),(0,cs.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await At.post("".concat(ms,"/contacts"),U,Bt()),Y({email:"",contact_name:""}),O(!1),Ut()}catch(a){var t,n;console.error("Error adding contact:",a),alert("Error adding contact: "+((null===(t=a.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.detail)||a.message))}},children:[(0,cs.jsxs)("div",{className:"space-y-4",children:[(0,cs.jsx)("input",{type:"email",placeholder:"Contact Email",value:U.email,onChange:e=>Y(l(l({},U),{},{email:e.target.value})),className:"w-full p-3 border rounded-lg",required:!0}),(0,cs.jsx)("input",{type:"text",placeholder:"Contact Name (optional)",value:U.contact_name,onChange:e=>Y(l(l({},U),{},{contact_name:e.target.value})),className:"w-full p-3 border rounded-lg"})]}),(0,cs.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,cs.jsx)("button",{type:"button",onClick:()=>O(!1),className:"flex-1 py-2 border rounded-lg",children:"Cancel"}),(0,cs.jsx)("button",{type:"submit",className:"flex-1 py-2 bg-blue-500 text-white rounded-lg",children:"Add Contact"})]})]})]})}),Q&&(0,cs.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,cs.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 max-w-[90vw]",children:[(0,cs.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Create Group"}),(0,cs.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await At.post("".concat(ms,"/chats"),{chat_type:"group",name:F.name,description:F.description,members:G},Bt()),J({name:"",description:"",members:[],chat_type:"group"}),Z([]),H(!1),Ot()}catch(a){var t,n;console.error("Error creating group:",a),alert("Error creating group: "+((null===(t=a.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.detail)||a.message))}},children:[(0,cs.jsxs)("div",{className:"space-y-4",children:[(0,cs.jsx)("input",{type:"text",placeholder:"Group Name",value:F.name,onChange:e=>J(l(l({},F),{},{name:e.target.value})),className:"w-full p-3 border rounded-lg",required:!0}),(0,cs.jsx)("textarea",{placeholder:"Group Description (optional)",value:F.description,onChange:e=>J(l(l({},F),{},{description:e.target.value})),className:"w-full p-3 border rounded-lg h-20"}),(0,cs.jsxs)("div",{children:[(0,cs.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Add Members:"}),(0,cs.jsx)("div",{className:"max-h-40 overflow-y-auto border rounded-lg",children:M.map((e=>{var t;return(0,cs.jsxs)("div",{className:"flex items-center p-2 hover:bg-gray-50",children:[(0,cs.jsx)("input",{type:"checkbox",checked:G.includes(e.contact_user_id),onChange:t=>{t.target.checked?Z([...G,e.contact_user_id]):Z(G.filter((t=>t!==e.contact_user_id)))},className:"mr-3"}),(0,cs.jsx)("span",{children:e.contact_name||(null===(t=e.contact_user)||void 0===t?void 0:t.username)})]},e.contact_user_id)}))})]})]}),(0,cs.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,cs.jsx)("button",{type:"button",onClick:()=>H(!1),className:"flex-1 py-2 border rounded-lg",children:"Cancel"}),(0,cs.jsx)("button",{type:"submit",className:"flex-1 py-2 bg-purple-500 text-white rounded-lg",children:"Create Group"})]})]})]})}),Ue&&(0,cs.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,cs.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 max-w-[90vw]",children:[(0,cs.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Create Channel"}),(0,cs.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await At.post("".concat(ms,"/channels"),Qe,Bt()),He({name:"",description:"",is_public:!0,category:"general"}),Ye(!1),Ht()}catch(a){var t,n;console.error("Error creating channel:",a),alert("Error creating channel: "+((null===(t=a.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.detail)||a.message))}},children:[(0,cs.jsxs)("div",{className:"space-y-4",children:[(0,cs.jsx)("input",{type:"text",placeholder:"Channel Name",value:Qe.name,onChange:e=>He(l(l({},Qe),{},{name:e.target.value})),className:"w-full p-3 border rounded-lg",required:!0}),(0,cs.jsx)("textarea",{placeholder:"Channel Description",value:Qe.description,onChange:e=>He(l(l({},Qe),{},{description:e.target.value})),className:"w-full p-3 border rounded-lg h-20"}),(0,cs.jsxs)("div",{className:"flex items-center",children:[(0,cs.jsx)("input",{type:"checkbox",checked:Qe.is_public,onChange:e=>He(l(l({},Qe),{},{is_public:e.target.checked})),className:"mr-3"}),(0,cs.jsx)("label",{children:"Public Channel"})]})]}),(0,cs.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,cs.jsx)("button",{type:"button",onClick:()=>Ye(!1),className:"flex-1 py-2 border rounded-lg",children:"Cancel"}),(0,cs.jsx)("button",{type:"submit",className:"flex-1 py-2 bg-blue-500 text-white rounded-lg",children:"Create Channel"})]})]})]})}),Te&&(0,cs.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,cs.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 max-w-[90vw]",children:[(0,cs.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Create Story"}),(0,cs.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await At.post("".concat(ms,"/stories"),De,Bt()),Re({content:"",media_type:"text",background_color:"#000000",text_color:"#ffffff",privacy:"all"}),Ae(!1),Qt()}catch(a){var t,n;console.error("Error creating story:",a),alert("Error creating story: "+((null===(t=a.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.detail)||a.message))}},children:[(0,cs.jsxs)("div",{className:"space-y-4",children:[(0,cs.jsx)("textarea",{placeholder:"What's on your mind?",value:De.content,onChange:e=>Re(l(l({},De),{},{content:e.target.value})),className:"w-full p-3 border rounded-lg h-32",required:!0}),(0,cs.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,cs.jsx)("label",{className:"text-sm",children:"Background:"}),(0,cs.jsx)("input",{type:"color",value:De.background_color,onChange:e=>Re(l(l({},De),{},{background_color:e.target.value})),className:"w-12 h-8 border rounded"}),(0,cs.jsx)("label",{className:"text-sm",children:"Text:"}),(0,cs.jsx)("input",{type:"color",value:De.text_color,onChange:e=>Re(l(l({},De),{},{text_color:e.target.value})),className:"w-12 h-8 border rounded"})]})]}),(0,cs.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,cs.jsx)("button",{type:"button",onClick:()=>Ae(!1),className:"flex-1 py-2 border rounded-lg",children:"Cancel"}),(0,cs.jsx)("button",{type:"submit",className:"flex-1 py-2 bg-pink-500 text-white rounded-lg",children:"Create Story"})]})]})]})}),Ve&&(0,cs.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,cs.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 max-w-[90vw]",children:[(0,cs.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Create Voice Room"}),(0,cs.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await At.post("".concat(ms,"/voice/rooms"),qe,Bt()),Xe({name:"",description:"",max_participants:50}),We(!1)}catch(a){var t,n;console.error("Error creating voice room:",a),alert("Error creating voice room: "+((null===(t=a.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.detail)||a.message))}},children:[(0,cs.jsxs)("div",{className:"space-y-4",children:[(0,cs.jsx)("input",{type:"text",placeholder:"Voice Room Name",value:qe.name,onChange:e=>Xe(l(l({},qe),{},{name:e.target.value})),className:"w-full p-3 border rounded-lg",required:!0}),(0,cs.jsx)("textarea",{placeholder:"Description (optional)",value:qe.description,onChange:e=>Xe(l(l({},qe),{},{description:e.target.value})),className:"w-full p-3 border rounded-lg h-20"}),(0,cs.jsx)("input",{type:"number",placeholder:"Max Participants",value:qe.max_participants,onChange:e=>Xe(l(l({},qe),{},{max_participants:parseInt(e.target.value)})),className:"w-full p-3 border rounded-lg",min:"2",max:"100"})]}),(0,cs.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,cs.jsx)("button",{type:"button",onClick:()=>We(!1),className:"flex-1 py-2 border rounded-lg",children:"Cancel"}),(0,cs.jsx)("button",{type:"submit",className:"flex-1 py-2 bg-orange-500 text-white rounded-lg",children:"Create Voice Room"})]})]})]})}),xt&&(0,cs.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,cs.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 max-w-[90vw]",children:[(0,cs.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Create Poll"}),(0,cs.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),m)try{await Vt()}catch(t){console.error("Error creating poll:",t)}else alert("Please select a chat first")},children:[(0,cs.jsxs)("div",{className:"space-y-4",children:[(0,cs.jsx)("input",{type:"text",placeholder:"Poll Question",value:kt.question,onChange:e=>Nt(l(l({},kt),{},{question:e.target.value})),className:"w-full p-3 border rounded-lg",required:!0}),kt.options.map(((e,t)=>(0,cs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,cs.jsx)("input",{type:"text",placeholder:"Option ".concat(t+1),value:e,onChange:e=>{const n=[...kt.options];n[t]=e.target.value,Nt(l(l({},kt),{},{options:n}))},className:"flex-1 p-3 border rounded-lg",required:!0}),kt.options.length>2&&(0,cs.jsx)("button",{type:"button",onClick:()=>{const e=kt.options.filter(((e,n)=>n!==t));Nt(l(l({},kt),{},{options:e}))},className:"text-red-500",children:"\u2715"})]},t))),(0,cs.jsx)("button",{type:"button",onClick:()=>Nt(l(l({},kt),{},{options:[...kt.options,""]})),className:"text-blue-500 text-sm",children:"+ Add Option"}),(0,cs.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,cs.jsxs)("label",{className:"flex items-center",children:[(0,cs.jsx)("input",{type:"checkbox",checked:kt.is_anonymous,onChange:e=>Nt(l(l({},kt),{},{is_anonymous:e.target.checked})),className:"mr-2"}),"Anonymous"]}),(0,cs.jsxs)("label",{className:"flex items-center",children:[(0,cs.jsx)("input",{type:"checkbox",checked:kt.allows_multiple_answers,onChange:e=>Nt(l(l({},kt),{},{allows_multiple_answers:e.target.checked})),className:"mr-2"}),"Multiple Answers"]})]})]}),(0,cs.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,cs.jsx)("button",{type:"button",onClick:()=>St(!1),className:"flex-1 py-2 border rounded-lg",children:"Cancel"}),(0,cs.jsx)("button",{type:"submit",className:"flex-1 py-2 bg-indigo-500 text-white rounded-lg",children:"Create Poll"})]})]})]})}),B&&(0,cs.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,cs.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 max-w-[90vw]",children:[(0,cs.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Add Contact"}),(0,cs.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await At.post("".concat(ms,"/contacts"),U,Bt()),Y({email:"",contact_name:""}),O(!1),Ut()}catch(a){var t,n;console.error("Error adding contact:",a),alert("Error adding contact: "+((null===(t=a.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.detail)||a.message))}},children:[(0,cs.jsxs)("div",{className:"space-y-4",children:[(0,cs.jsx)("input",{type:"email",placeholder:"Contact Email",value:U.email,onChange:e=>Y(l(l({},U),{},{email:e.target.value})),className:"w-full p-3 border rounded-lg",required:!0}),(0,cs.jsx)("input",{type:"text",placeholder:"Contact Name (optional)",value:U.contact_name,onChange:e=>Y(l(l({},U),{},{contact_name:e.target.value})),className:"w-full p-3 border rounded-lg"})]}),(0,cs.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,cs.jsx)("button",{type:"button",onClick:()=>O(!1),className:"flex-1 py-2 border rounded-lg",children:"Cancel"}),(0,cs.jsx)("button",{type:"submit",className:"flex-1 py-2 bg-blue-500 text-white rounded-lg",children:"Add Contact"})]})]})]})}),Q&&(0,cs.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,cs.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 max-w-[90vw]",children:[(0,cs.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Create Group"}),(0,cs.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await At.post("".concat(ms,"/chats"),{chat_type:"group",name:F.name,description:F.description,members:G},Bt()),J({name:"",description:"",members:[],chat_type:"group"}),Z([]),H(!1),Ot()}catch(a){var t,n;console.error("Error creating group:",a),alert("Error creating group: "+((null===(t=a.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.detail)||a.message))}},children:[(0,cs.jsxs)("div",{className:"space-y-4",children:[(0,cs.jsx)("input",{type:"text",placeholder:"Group Name",value:F.name,onChange:e=>J(l(l({},F),{},{name:e.target.value})),className:"w-full p-3 border rounded-lg",required:!0}),(0,cs.jsx)("textarea",{placeholder:"Group Description (optional)",value:F.description,onChange:e=>J(l(l({},F),{},{description:e.target.value})),className:"w-full p-3 border rounded-lg h-20"}),(0,cs.jsxs)("div",{children:[(0,cs.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Add Members:"}),(0,cs.jsx)("div",{className:"max-h-40 overflow-y-auto border rounded-lg",children:M.map((e=>{var t;return(0,cs.jsxs)("div",{className:"flex items-center p-2 hover:bg-gray-50",children:[(0,cs.jsx)("input",{type:"checkbox",checked:G.includes(e.contact_user_id),onChange:t=>{t.target.checked?Z([...G,e.contact_user_id]):Z(G.filter((t=>t!==e.contact_user_id)))},className:"mr-3"}),(0,cs.jsx)("span",{children:e.contact_name||(null===(t=e.contact_user)||void 0===t?void 0:t.username)})]},e.contact_user_id)}))})]})]}),(0,cs.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,cs.jsx)("button",{type:"button",onClick:()=>H(!1),className:"flex-1 py-2 border rounded-lg",children:"Cancel"}),(0,cs.jsx)("button",{type:"submit",className:"flex-1 py-2 bg-purple-500 text-white rounded-lg",children:"Create Group"})]})]})]})}),Ue&&(0,cs.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,cs.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 max-w-[90vw]",children:[(0,cs.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Create Channel"}),(0,cs.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await At.post("".concat(ms,"/channels"),Qe,Bt()),He({name:"",description:"",is_public:!0,category:"general"}),Ye(!1),Ht()}catch(a){var t,n;console.error("Error creating channel:",a),alert("Error creating channel: "+((null===(t=a.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.detail)||a.message))}},children:[(0,cs.jsxs)("div",{className:"space-y-4",children:[(0,cs.jsx)("input",{type:"text",placeholder:"Channel Name",value:Qe.name,onChange:e=>He(l(l({},Qe),{},{name:e.target.value})),className:"w-full p-3 border rounded-lg",required:!0}),(0,cs.jsx)("textarea",{placeholder:"Channel Description",value:Qe.description,onChange:e=>He(l(l({},Qe),{},{description:e.target.value})),className:"w-full p-3 border rounded-lg h-20"}),(0,cs.jsxs)("div",{className:"flex items-center",children:[(0,cs.jsx)("input",{type:"checkbox",checked:Qe.is_public,onChange:e=>He(l(l({},Qe),{},{is_public:e.target.checked})),className:"mr-3"}),(0,cs.jsx)("label",{children:"Public Channel"})]})]}),(0,cs.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,cs.jsx)("button",{type:"button",onClick:()=>Ye(!1),className:"flex-1 py-2 border rounded-lg",children:"Cancel"}),(0,cs.jsx)("button",{type:"submit",className:"flex-1 py-2 bg-blue-500 text-white rounded-lg",children:"Create Channel"})]})]})]})}),Te&&(0,cs.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,cs.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 max-w-[90vw]",children:[(0,cs.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Create Story"}),(0,cs.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await At.post("".concat(ms,"/stories"),De,Bt()),Re({content:"",media_type:"text",background_color:"#000000",text_color:"#ffffff",privacy:"all"}),Ae(!1),Qt()}catch(a){var t,n;console.error("Error creating story:",a),alert("Error creating story: "+((null===(t=a.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.detail)||a.message))}},children:[(0,cs.jsxs)("div",{className:"space-y-4",children:[(0,cs.jsx)("textarea",{placeholder:"What's on your mind?",value:De.content,onChange:e=>Re(l(l({},De),{},{content:e.target.value})),className:"w-full p-3 border rounded-lg h-32",required:!0}),(0,cs.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,cs.jsx)("label",{className:"text-sm",children:"Background:"}),(0,cs.jsx)("input",{type:"color",value:De.background_color,onChange:e=>Re(l(l({},De),{},{background_color:e.target.value})),className:"w-12 h-8 border rounded"}),(0,cs.jsx)("label",{className:"text-sm",children:"Text:"}),(0,cs.jsx)("input",{type:"color",value:De.text_color,onChange:e=>Re(l(l({},De),{},{text_color:e.target.value})),className:"w-12 h-8 border rounded"})]})]}),(0,cs.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,cs.jsx)("button",{type:"button",onClick:()=>Ae(!1),className:"flex-1 py-2 border rounded-lg",children:"Cancel"}),(0,cs.jsx)("button",{type:"submit",className:"flex-1 py-2 bg-pink-500 text-white rounded-lg",children:"Create Story"})]})]})]})}),Ve&&(0,cs.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,cs.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 max-w-[90vw]",children:[(0,cs.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Create Voice Room"}),(0,cs.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await At.post("".concat(ms,"/voice/rooms"),qe,Bt()),Xe({name:"",description:"",max_participants:50}),We(!1)}catch(a){var t,n;console.error("Error creating voice room:",a),alert("Error creating voice room: "+((null===(t=a.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.detail)||a.message))}},children:[(0,cs.jsxs)("div",{className:"space-y-4",children:[(0,cs.jsx)("input",{type:"text",placeholder:"Voice Room Name",value:qe.name,onChange:e=>Xe(l(l({},qe),{},{name:e.target.value})),className:"w-full p-3 border rounded-lg",required:!0}),(0,cs.jsx)("textarea",{placeholder:"Description (optional)",value:qe.description,onChange:e=>Xe(l(l({},qe),{},{description:e.target.value})),className:"w-full p-3 border rounded-lg h-20"}),(0,cs.jsx)("input",{type:"number",placeholder:"Max Participants",value:qe.max_participants,onChange:e=>Xe(l(l({},qe),{},{max_participants:parseInt(e.target.value)})),className:"w-full p-3 border rounded-lg",min:"2",max:"100"})]}),(0,cs.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,cs.jsx)("button",{type:"button",onClick:()=>We(!1),className:"flex-1 py-2 border rounded-lg",children:"Cancel"}),(0,cs.jsx)("button",{type:"submit",className:"flex-1 py-2 bg-orange-500 text-white rounded-lg",children:"Create Voice Room"})]})]})]})}),xt&&(0,cs.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,cs.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 max-w-[90vw]",children:[(0,cs.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Create Poll"}),(0,cs.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),m)try{await Vt()}catch(t){console.error("Error creating poll:",t)}else alert("Please select a chat first")},children:[(0,cs.jsxs)("div",{className:"space-y-4",children:[(0,cs.jsx)("input",{type:"text",placeholder:"Poll Question",value:kt.question,onChange:e=>Nt(l(l({},kt),{},{question:e.target.value})),className:"w-full p-3 border rounded-lg",required:!0}),kt.options.map(((e,t)=>(0,cs.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,cs.jsx)("input",{type:"text",placeholder:"Option ".concat(t+1),value:e,onChange:e=>{const n=[...kt.options];n[t]=e.target.value,Nt(l(l({},kt),{},{options:n}))},className:"flex-1 p-3 border rounded-lg",required:!0}),kt.options.length>2&&(0,cs.jsx)("button",{type:"button",onClick:()=>{const e=kt.options.filter(((e,n)=>n!==t));Nt(l(l({},kt),{},{options:e}))},className:"text-red-500",children:"\u2715"})]},t))),(0,cs.jsx)("button",{type:"button",onClick:()=>Nt(l(l({},kt),{},{options:[...kt.options,""]})),className:"text-blue-500 text-sm",children:"+ Add Option"}),(0,cs.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,cs.jsxs)("label",{className:"flex items-center",children:[(0,cs.jsx)("input",{type:"checkbox",checked:kt.is_anonymous,onChange:e=>Nt(l(l({},kt),{},{is_anonymous:e.target.checked})),className:"mr-2"}),"Anonymous"]}),(0,cs.jsxs)("label",{className:"flex items-center",children:[(0,cs.jsx)("input",{type:"checkbox",checked:kt.allows_multiple_answers,onChange:e=>Nt(l(l({},kt),{},{allows_multiple_answers:e.target.checked})),className:"mr-2"}),"Multiple Answers"]})]})]}),(0,cs.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,cs.jsx)("button",{type:"button",onClick:()=>St(!1),className:"flex-1 py-2 border rounded-lg",children:"Cancel"}),(0,cs.jsx)("button",{type:"submit",className:"flex-1 py-2 bg-indigo-500 text-white rounded-lg",children:"Create Poll"})]})]})]})}),u&&(0,cs.jsx)(ps,{user:u,token:d,onAction:async e=>{try{switch(e.type){case"create_chat":if(e.target_user){const t=await At.get("".concat(ms,"/users/search?query=").concat(e.target_user),Bt()),n=t.data.find((t=>{var n;return t.username.toLowerCase().includes(e.target_user.toLowerCase())||(null===(n=t.display_name)||void 0===n?void 0:n.toLowerCase().includes(e.target_user.toLowerCase()))||t.email.toLowerCase().includes(e.target_user.toLowerCase())}));if(n){const e=await At.post("".concat(ms,"/chats"),{chat_type:"direct",other_user_id:n.user_id},Bt());return Ot(),b(e.data),{success:!0,message:"Chat created with ".concat(n.username,"!")}}return{success:!1,message:"Couldn't find user: ".concat(e.target_user)}}break;case"create_group":const t=await At.post("".concat(ms,"/chats"),{chat_type:"group",name:e.name,members:[]},Bt());return Ot(),b(t.data),{success:!0,message:'Group "'.concat(e.name,'" created!')};case"add_contact":await At.post("".concat(ms,"/contacts"),{email:e.contact_info,contact_name:e.contact_info.split("@")[0]},Bt());return Ut(),{success:!0,message:"Contact added: ".concat(e.contact_info)};case"send_message":if(e.recipient&&e.message){const t=await At.get("".concat(ms,"/users/search?query=").concat(e.recipient),Bt()),n=t.data.find((t=>{var n;return t.username.toLowerCase().includes(e.recipient.toLowerCase())||(null===(n=t.display_name)||void 0===n?void 0:n.toLowerCase().includes(e.recipient.toLowerCase()))}));if(n){const t=await At.post("".concat(ms,"/chats"),{chat_type:"direct",other_user_id:n.user_id},Bt());return await At.post("".concat(ms,"/chats/").concat(t.data.chat_id,"/messages"),{content:e.message,message_type:"text"},Bt()),Ot(),{success:!0,message:"Message sent to ".concat(n.username,"!")}}}break;case"block_user":if(e.target_user){const t=await At.get("".concat(ms,"/users/search?query=").concat(e.target_user),Bt()),n=t.data.find((t=>{var n;return t.username.toLowerCase().includes(e.target_user.toLowerCase())||(null===(n=t.display_name)||void 0===n?void 0:n.toLowerCase().includes(e.target_user.toLowerCase()))}));if(n)return await At.post("".concat(ms,"/users/").concat(n.user_id,"/block"),{},Bt()),Yt(),{success:!0,message:"User ".concat(n.username," blocked!")}}break;case"list_chats":return Ot(),{success:!0,message:"Your chats are now displayed!"};case"list_contacts":return Ut(),{success:!0,message:"Your contacts are now displayed!"};case"show_help":return{success:!0,message:"Here are the magical commands I understand:\n\u2022 Create chat with [name]\n\u2022 Add contact [email]\n\u2022 Send message to [name] saying [message]\n\u2022 Block user [name]\n\u2022 Show my chats/contacts\n\u2022 Create group called [name]\n\u2022 Create story [content]"};case"show_settings":return{success:!0,message:"Settings portal is now accessible through the app interface!"};default:return{success:!1,message:"Unknown action type"}}}catch(a){var t,n;return console.error("Genie action error:",a),{success:!1,message:"Error: ".concat((null===(t=a.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.detail)||a.message)}}return{success:!1,message:"Action could not be completed"}}})]})};r.createRoot(document.getElementById("root")).render((0,cs.jsx)(a.StrictMode,{children:(0,cs.jsx)(ws,{})}))})()})();
//# sourceMappingURL=main.775e75bc.js.map