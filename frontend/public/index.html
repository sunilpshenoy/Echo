<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#4A1A5C" />
  <meta name="description" content="Pulse - Connect Securely. Build genuine relationships through progressive trust and safe connections." />
  
  <!-- PWA Configuration -->
  <link rel="apple-touch-icon" href="%PUBLIC_URL%/icon-192.png" />
  <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
  
  <!-- Additional PWA Meta Tags -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Pulse">
  <meta name="mobile-web-app-capable" content="yes">
  
  <title>Pulse - Connect Securely</title>
</head>
<body>
  <noscript>You need to enable JavaScript to run this app.</noscript>
  <div id="root"></div>
  
  <!-- PWA Install Prompt -->
  <div id="install-banner" style="display: none; position: fixed; top: 0; left: 0; right: 0; background: #4A1A5C; color: white; padding: 12px; text-align: center; z-index: 10000;">
    <span>ðŸ“± Install Pulse app for the best experience!</span>
    <button id="install-btn" style="margin-left: 10px; background: white; color: #4A1A5C; border: none; padding: 5px 10px; border-radius: 4px; font-weight: bold;">Install</button>
    <button id="dismiss-btn" style="margin-left: 5px; background: transparent; color: white; border: 1px solid white; padding: 5px 10px; border-radius: 4px;">Later</button>
  </div>
  
  <!-- Register Service Worker for PWA -->
  <script>
    let deferredPrompt;
    
    // Register service worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('%PUBLIC_URL%/sw.js')
          .then(registration => {
            console.log('âœ… SW registered: ', registration);
          })
          .catch(registrationError => {
            console.log('âŒ SW registration failed: ', registrationError);
          });
      });
    }
    
    // Listen for install prompt
    window.addEventListener('beforeinstallprompt', (e) => {
      console.log('âœ… PWA install prompt available');
      e.preventDefault();
      deferredPrompt = e;
      
      // Show install banner
      document.getElementById('install-banner').style.display = 'block';
    });
    
    // Handle install button click
    document.addEventListener('DOMContentLoaded', () => {
      const installBtn = document.getElementById('install-btn');
      const dismissBtn = document.getElementById('dismiss-btn');
      const banner = document.getElementById('install-banner');
      
      installBtn.addEventListener('click', async () => {
        if (deferredPrompt) {
          deferredPrompt.prompt();
          const { outcome } = await deferredPrompt.userChoice;
          console.log('PWA install outcome:', outcome);
          deferredPrompt = null;
        }
        banner.style.display = 'none';
      });
      
      dismissBtn.addEventListener('click', () => {
        banner.style.display = 'none';
      });
    });
    
    // Handle successful installation
    window.addEventListener('appinstalled', (e) => {
      console.log('âœ… PWA installed successfully');
      document.getElementById('install-banner').style.display = 'none';
    });
  </script>
</body>
</html>
